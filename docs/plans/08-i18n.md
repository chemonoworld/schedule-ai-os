# 08. i18n (다국어 지원)

## 개요

Schedule AI 앱의 다국어 지원 구현. 현재 한국어(ko)와 영어(en)를 지원하며, 추후 다른 언어로 확장 가능한 구조.

## 목표

- 한국어 + 영어 지원 (확장 가능)
- 영어를 기본/폴백 언어로 설정
- macOS 시스템 언어 자동 감지
- 설정에서 수동 언어 변경 가능
- 네임스페이스 기반 번역 파일 구조

---

## 기술 스택

| 라이브러리 | 용도 |
|-----------|------|
| i18next | 핵심 i18n 엔진 |
| react-i18next | React 통합 (useTranslation hook) |
| Tauri invoke | 시스템 언어 감지 (Rust) |
| Zustand | 언어 상태 관리 (settingsStore) |

---

## 디렉토리 구조

```
src/i18n/
├── index.ts              # i18n 초기화 설정
├── types.ts              # TypeScript 타입 정의
└── locales/
    ├── en/               # 영어 번역
    │   ├── common.json
    │   ├── today.json
    │   ├── plans.json
    │   ├── progress.json
    │   ├── focus.json
    │   └── settings.json
    └── ko/               # 한국어 번역
        ├── common.json
        ├── today.json
        ├── plans.json
        ├── progress.json
        ├── focus.json
        └── settings.json
```

---

## 네임스페이스 구조

| 네임스페이스 | 설명 |
|-------------|------|
| common | 공통 UI (탭, 버튼, 날짜 등) |
| today | Today 탭 관련 |
| plans | Plans 탭 관련 |
| progress | Progress 탭 관련 |
| focus | Focus 탭 관련 |
| settings | Settings 탭 관련 |

---

## Rust 백엔드 커맨드

### get_system_locale
macOS 시스템 언어 감지

```rust
#[tauri::command]
fn get_system_locale() -> String {
    #[cfg(target_os = "macos")]
    {
        use std::process::Command;
        if let Ok(output) = Command::new("defaults")
            .args(["read", "-g", "AppleLocale"])
            .output()
        {
            if let Ok(locale) = String::from_utf8(output.stdout) {
                return locale.trim().split('_').next().unwrap_or("en").to_string();
            }
        }
    }
    "en".to_string()
}
```

### get_language / set_language
언어 설정 저장/로드 (Tauri PathResolver 사용)

---

## 프론트엔드 통합

### settingsStore.ts

```typescript
interface SettingsState {
  language: Language;
  isInitialized: boolean;
  initLanguage: () => Promise<void>;
  setLanguage: (lang: Language) => Promise<void>;
}
```

### main.tsx
- `AppWithI18n` 래퍼 컴포넌트
- 언어 초기화 완료 전 빈 화면 표시

### useTranslation 사용
```typescript
const { t } = useTranslation();

// 기본 네임스페이스 (common)
t('tabs.today')

// 다른 네임스페이스
t('focus:timer.elapsed')
t('settings:language.title')

// 변수 보간
t('focus:notification.terminated', { appName })
```

---

## UI 언어 선택

Settings 탭에서 언어 선택 드롭다운 제공:
- English
- 한국어

변경 시 즉시 적용 (페이지 새로고침 불필요)

---

## 구현 상태

- [x] i18next, react-i18next 설치
- [x] i18n 디렉토리 구조 생성
- [x] 영어/한국어 번역 파일 작성 (6개 네임스페이스)
- [x] Rust 백엔드 커맨드 (get_system_locale, get_language, set_language)
- [x] settingsStore.ts 생성
- [x] main.tsx 수정 (i18n 초기화)
- [x] App.tsx 전체 마이그레이션 (모든 UI 텍스트)
  - [x] 네비게이션 탭
  - [x] Today 탭 (날짜, 진행률, 태스크 목록, 추가 폼)
  - [x] Plans 탭 (반복 일정, 데일리 플랜, 플랜 목록)
  - [x] Progress 탭 (스트릭, 히트맵, 통계)
  - [x] Settings 탭 (언어, API 키, 단축키, 규칙, 내보내기)
  - [x] SwipeableTask 컴포넌트
  - [x] 모든 모달 (태스크 수정, 쪼개기, 서브태스크, 플랜 수정)
- [x] focusStore.ts 알림 메시지 번역 적용
- [x] Settings 탭 언어 선택 UI
- [x] 빌드 테스트 완료

---

## 향후 확장

- 추가 언어 지원 (일본어, 중국어 등)
- 날짜/시간 포맷 로케일화
- RTL (Right-to-Left) 언어 지원

---

마지막 업데이트: 2026-01-01
